{"version":3,"file":"use-draggable-auto-scroll-BAAmpSao.js","names":[],"sources":["../src/hooks/use-draggable-auto-scroll.ts"],"sourcesContent":["import type { Draggable, DraggablePluginMap } from 'dragdoll/draggable';\nimport type { DraggableAutoScrollOptions } from 'dragdoll/draggable/plugins/auto-scroll';\nimport { autoScrollPlugin } from 'dragdoll/draggable/plugins/auto-scroll';\nimport type { Sensor } from 'dragdoll/sensors';\nimport { useRef } from 'react';\nimport { areConfigsEqual } from '../utils/are-configs-equal.js';\nimport { useIsomorphicLayoutEffect } from './use-isomorphic-layout-effect.js';\n\ntype DraggableWithAutoScroll<\n  S extends Sensor = Sensor,\n  // eslint-disable-next-line @typescript-eslint/no-empty-object-type\n  P extends DraggablePluginMap = {},\n> = ReturnType<ReturnType<typeof autoScrollPlugin<S, P>>> | null;\n\nexport type UseDraggableAutoScrollSettings<S extends Sensor = Sensor> =\n  DraggableAutoScrollOptions<S>;\n\nexport function useDraggableAutoScroll<\n  S extends Sensor = Sensor,\n  // eslint-disable-next-line @typescript-eslint/no-empty-object-type\n  P extends DraggablePluginMap = {},\n>(draggable: Draggable<S, P> | null, settings?: UseDraggableAutoScrollSettings<S>) {\n  // Store settings in ref for stable access in effects.\n  const settingsRef = useRef(settings);\n  settingsRef.current = settings;\n\n  // Store applied settings for deep equality check.\n  const appliedSettingsRef = useRef(settings);\n\n  // Register plugin when draggable changes (only once per draggable instance)\n  useIsomorphicLayoutEffect(() => {\n    // If the draggable is not ready, return.\n    if (!draggable) return;\n\n    // If the plugin is already registered, skip registration.\n    if (draggable.plugins.autoscroll) return;\n\n    // Register the plugin.\n    draggable.use(autoScrollPlugin<S, P>(settingsRef.current));\n\n    // Update the applied settings.\n    appliedSettingsRef.current = settingsRef.current;\n  }, [draggable]);\n\n  // Update settings when settings change.\n  useIsomorphicLayoutEffect(() => {\n    const plugin = (draggable as DraggableWithAutoScroll<S, P>)?.plugins.autoscroll;\n    if (!plugin) return;\n\n    // Only update if settings have actually changed (deep equality check).\n    // This prevents unnecessary updates when settings object reference changes\n    // but values remain the same.\n    if (!areConfigsEqual(appliedSettingsRef.current, settings)) {\n      // Here we use the protected method to parse the settings so that we can\n      // use the default settings for the ones that are not provided. This is the\n      // expected behavior in React's declarative nature.\n      plugin.updateSettings(plugin['_parseSettings'](settings));\n    }\n\n    // Update the applied settings.\n    appliedSettingsRef.current = settings;\n  }, [draggable, settings]);\n\n  // Return typed draggable with plugin\n  return draggable as DraggableWithAutoScroll<S, P>;\n}\n"],"mappings":"uNAiBA,SAAgB,EAId,EAAmC,EAA8C,CAEjF,IAAM,EAAc,EAAO,EAAS,CACpC,EAAY,QAAU,EAGtB,IAAM,EAAqB,EAAO,EAAS,CAqC3C,OAlCA,MAAgC,CAEzB,IAGD,EAAU,QAAQ,aAGtB,EAAU,IAAI,EAAuB,EAAY,QAAQ,CAAC,CAG1D,EAAmB,QAAU,EAAY,WACxC,CAAC,EAAU,CAAC,CAGf,MAAgC,CAC9B,IAAM,EAAU,GAA6C,QAAQ,WAChE,IAKA,EAAgB,EAAmB,QAAS,EAAS,EAIxD,EAAO,eAAe,EAAO,eAAkB,EAAS,CAAC,CAI3D,EAAmB,QAAU,IAC5B,CAAC,EAAW,EAAS,CAAC,CAGlB"}