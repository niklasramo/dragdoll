import{n as e,t}from"./get-intersection-score-YcxwkZs7.js";function n(e,t={width:0,height:0,x:0,y:0}){return e&&(t.width=e.width,t.height=e.height,t.x=e.x,t.y=e.y),t}var r=class{_items;_index;_initItem;constructor(e){this._items=[],this._index=0,this._initItem=e}allocate(...e){let t=this._index,n=this._items,r=this._initItem(n[t],...e);return n[t]=r,++this._index,r}reset(){this._index=0}truncate(e=0){let t=Math.max(0,Math.min(e,this._items.length));this._index=Math.min(this._index,t),this._items.length=t}};const i=Symbol();var a=class{_listenerId;_dndObserver;_cdArenaPool;_cdArenaMap;constructor(e){this._listenerId=Symbol(),this._dndObserver=e,this._cdArenaPool=[],this._cdArenaMap=new Map}_checkCollision(r,i,a){let o=r.getClientRect(),s=i.getClientRect();if(!o)return null;let c=e(o,s,a.intersectionRect);if(c===null)return null;let l=t(o,s,c);return l<=0?null:(a.droppableId=i.id,n(s,a.droppableRect),n(o,a.draggableRect),a.intersectionScore=l,a)}_sortCollisions(e,t){return t.sort((e,t)=>{let n=t.intersectionScore-e.intersectionScore;return n===0?e.droppableRect.width*e.droppableRect.height-t.droppableRect.width*t.droppableRect.height:n})}_createCollisionData(){return{droppableId:i,droppableRect:n(),draggableRect:n(),intersectionRect:n(),intersectionScore:0}}_getCollisionDataArena(e){let t=this._cdArenaMap.get(e);return t||(t=this._cdArenaPool.pop()||new r(e=>e||this._createCollisionData()),this._cdArenaMap.set(e,t)),t}_removeCollisionDataArena(e){let t=this._cdArenaMap.get(e);t&&(t.truncate(20),t.reset(),this._cdArenaPool.push(t),this._cdArenaMap.delete(e))}detectCollisions(e,t,n){if(n.length=0,!t.size)return;let r=this._getCollisionDataArena(e),i=null,a=t.values();for(let t of a)i||=r.allocate(),this._checkCollision(e,t,i)&&(n.push(i),i=null);n.length>1&&this._sortCollisions(e,n),r.reset()}destroy(){this._cdArenaMap.forEach(e=>{e.truncate()})}};export{n,a as t};
//# sourceMappingURL=collision-detector-DevU0v1G.js.map