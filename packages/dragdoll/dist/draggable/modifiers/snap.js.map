{"version":3,"file":"snap.js","names":["snapState: { snapX: number; snapY: number; sensorX: number; sensorY: number }"],"sources":["../../../src/draggable/modifiers/create-snap-modifier.ts"],"sourcesContent":["import type { Sensor } from '../../sensors/sensor.js';\n\nimport type { DraggableModifier } from '../draggable.js';\n\nfunction round(value: number, multipleOf: number) {\n  return Math.round(value / multipleOf) * multipleOf;\n}\n\nfunction getAxisChange(cellSize: number, snapPosition: number, sensorPosition: number) {\n  const change = sensorPosition - snapPosition;\n  const changeAbs = Math.abs(change);\n  if (changeAbs >= cellSize) {\n    const overflow = changeAbs % cellSize;\n    return round(change > 0 ? change - overflow : change + overflow, cellSize);\n  }\n  return 0;\n}\n\nexport function createSnapModifier<S extends Sensor[], E extends S[number]['_events_type']>(\n  cellWidth: number,\n  cellHeight: number,\n) {\n  return function snapModifier(change, { item }) {\n    const snapState: { snapX: number; snapY: number; sensorX: number; sensorY: number } =\n      item.data.__snap__ ||\n      (item.data.__snap__ = {\n        snapX: 0,\n        snapY: 0,\n        sensorX: 0,\n        sensorY: 0,\n      });\n\n    // Add the change to the sensor position.\n    snapState.sensorX += change.x;\n    snapState.sensorY += change.y;\n\n    // Compute the change on the x and y axis.\n    const changeX = getAxisChange(cellWidth, snapState.snapX, snapState.sensorX);\n    const changeY = getAxisChange(cellHeight, snapState.snapY, snapState.sensorY);\n\n    // Add the change to the snap position.\n    snapState.snapX += changeX;\n    snapState.snapY += changeY;\n\n    // Update the change.\n    change.x = changeX;\n    change.y = changeY;\n\n    return change;\n  } as DraggableModifier<S, E>;\n}\n"],"mappings":"AAIA,SAAS,EAAM,EAAe,EAAoB,CAChD,OAAO,KAAK,MAAM,EAAQ,EAAW,CAAG,EAG1C,SAAS,EAAc,EAAkB,EAAsB,EAAwB,CACrF,IAAM,EAAS,EAAiB,EAC1B,EAAY,KAAK,IAAI,EAAO,CAClC,GAAI,GAAa,EAAU,CACzB,IAAM,EAAW,EAAY,EAC7B,OAAO,EAAM,EAAS,EAAI,EAAS,EAAW,EAAS,EAAU,EAAS,CAE5E,MAAO,GAGT,SAAgB,EACd,EACA,EACA,CACA,OAAO,SAAsB,EAAQ,CAAE,QAAQ,CAC7C,IAAMA,EACJ,EAAK,KAAK,WACT,EAAK,KAAK,SAAW,CACpB,MAAO,EACP,MAAO,EACP,QAAS,EACT,QAAS,EACV,EAGH,EAAU,SAAW,EAAO,EAC5B,EAAU,SAAW,EAAO,EAG5B,IAAM,EAAU,EAAc,EAAW,EAAU,MAAO,EAAU,QAAQ,CACtE,EAAU,EAAc,EAAY,EAAU,MAAO,EAAU,QAAQ,CAU7E,MAPA,GAAU,OAAS,EACnB,EAAU,OAAS,EAGnB,EAAO,EAAI,EACX,EAAO,EAAI,EAEJ"}